/**
 * @license react-anchor-navigation 0.2.2
 * MIT License
 * License: MIT
 */
import e,{createContext as t,useContext as r,useState as n,useEffect as s,useRef as c}from"react";var o=()=>{},a=t({offset:0,sections:[],hash:"",registerSection:o,unregisterSection:o,setHash:o});function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function u(t){var{children:n,className:s,activeClassName:c}=t,o=i(t,["children","className","activeClassName"]),{hash:u}=r(a),v=(s?"".concat(s," "):"")+(u===o.href?c:"");return e.createElement("a",l({},o,{className:v}),n)}var v="undefined"!=typeof addEventListener&&(()=>{var e=!1;try{var t=()=>{},r=Object.defineProperty({},"passive",{get:()=>e=!0});addEventListener("testPassive",t,r),removeEventListener("testPassive",t,r)}catch(e){}return e})();var f=(e,t)=>{var r=0,n=e;do{r+=n.offsetTop,n=n.offsetParent}while(n&&n!==t);return r},h=v&&{capture:!1,passive:!0};function d(e,t){s(()=>{var r=()=>{var{blockScrollEvent:r,sections:n,scroller:s,offset:c}=e.current;if(!r&&n.length){var o=(s?s.scrollTop:window.pageYOffset||document.documentElement.scrollTop)+c;if(f(n[0],s)>o)t("#",!1);else{var a=n.findIndex(e=>f(e,s)>o),l=-1===a?n[n.length-1]:n[Math.max(a-1,0)];l&&t("#".concat(l.id),!1)}}},n=function(e,t){var r=null;function n(){r||(r=setTimeout(()=>{r=null,e()},t))}return n.cancel=()=>{r&&(clearTimeout(r),r=null)},n}(r,100);return addEventListener("scroll",n,h),r(),()=>{removeEventListener("scroll",n,h),n.cancel()}},[])}function p(t){var{children:r,getScroller:o,offset:l=0}=t,i=c({offset:l,sections:[],blockScrollEvent:!1,scroller:null});o&&(i.current.scroller=o());var[u,v]=function(e){var[t,r]=n("");return s(()=>{var t=t=>{r(location.hash),t&&"hashchange"===t.type&&(e.current.blockScrollEvent=!0,setTimeout(()=>{e.current.blockScrollEvent=!1},100))};return addEventListener("hashchange",t,!1),addEventListener("popstate",t,!1),t(),()=>{removeEventListener("hashchange",t,!1),removeEventListener("popstate",t,!1)}},[]),[t,function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r(e),globalThis.history&&globalThis.location&&(!t&&"pushState"in history?history.pushState(null,e.substr(1),e):location.hash=e)}]}(i);d(i,v);return e.createElement(a.Provider,{value:{offset:l,hash:u,sections:i.current.sections,setHash:v,registerSection:e=>{var{sections:t,scroller:r}=i.current;if(!t.includes(e)){var n=f(e,r),s=t.findIndex(e=>f(e,r)>n);-1===s?t.push(e):t.splice(s,0,e)}},unregisterSection:e=>{var t=i.current.sections.indexOf(e);-1!==t&&i.current.sections.splice(t,1)}}},r)}function m(t){var{children:n}=t,o=i(t,["children"]),{registerSection:u,unregisterSection:v}=r(a),f=c(null);return s(()=>(f.current&&(u(f.current),o.id===location.hash.substr(1)&&f.current.scrollIntoView()),()=>{f.current&&v(f.current)}),[]),e.createElement(e.Fragment,null,e.createElement("b",l({},o,{ref:f})),n)}export{a as AnchorContext,u as AnchorLink,p as AnchorProvider,m as AnchorSection};
